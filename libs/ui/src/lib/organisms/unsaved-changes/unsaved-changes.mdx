import { ArgTypes, Canvas, Meta } from '@storybook/addon-docs/blocks';
import { MmcUnsavedChanges } from './unsaved-changes.component';
import * as UnsavedChangesStories from './unsaved-changes.stories';

<Meta title="Organisms/Unsaved Changes" />

# Unsaved Changes

#### Reusable component to detect and handle unsaved changes with Dialog and Banner variants.

<Canvas sourceState="hidden" of={UnsavedChangesStories.BannerVariant} />

## Features

- ✅ **Dialog Mode**: Standard confirmation dialog.
- ✅ **Banner Mode**: Bottom banner with "jiggle" animation on navigation attempt.
- ✅ **Guard Integration**: Easy integration with Angular Router via `unsavedChangesGuard`.
- ✅ **Customizable**: Configurable texts and labels.

## Import

```typescript
import { MmcUnsavedChanges, unsavedChangesGuard } from '@mmc/ui';
```

## Usage

### 1. Register the Guard

Apply `unsavedChangesGuard` to your route.

```typescript
const routes: Routes = [
  {
    path: 'edit',
    component: EditComponent,
    canDeactivate: [unsavedChangesGuard],
  },
];
```

### 2. Implement Component

Use the component in your template and implement `canDeactivate`.

```typescript
@Component({
  template: `
    <mmc-unsaved-changes
      [hasUnsavedChanges]="form.dirty"
      mode="banner"
      (save)="onSave()"
      (reset)="onReset()"
    ></mmc-unsaved-changes>
  `
})
export class EditComponent {
  @ViewChild(MmcUnsavedChanges) unsavedChanges!: MmcUnsavedChanges;

  canDeactivate() {
    return this.unsavedChanges.canDeactivate();
  }
}
```

## Examples

### Banner Mode

```html
<mmc-unsaved-changes
  [hasUnsavedChanges]="true"
  mode="banner"
  title="Unsaved changes!"
  description="Do you want to save or discard?"
></mmc-unsaved-changes>
```

### Dialog Mode

```html
<mmc-unsaved-changes
  [hasUnsavedChanges]="true"
  mode="dialog"
></mmc-unsaved-changes>
```

## API Reference

<ArgTypes of={MmcUnsavedChanges} />
