import { ArgTypes, Canvas, Meta } from '@storybook/addon-docs/blocks';
import { ThemeManagerComponent } from './theme-manager.component';
import * as ThemeManagerStories from './theme-manager.stories';

<Meta title="Organisms/Theme Manager" />

# Theme Manager

#### A component that allows users to switch between different color themes including a custom theme option.

<Canvas sourceState="hidden" of={ThemeManagerStories.Default} />

## Features

- ✅ Pre-defined themes (Light, Dark, Auto)
- ✅ Custom theme with color picker
- ✅ Persists theme preference in localStorage
- ✅ Auto theme based on system preference
- ✅ Runtime color customization

## Import

Get started with importing the component:

```typescript
import { ThemeManagerComponent, ThemeManager } from '@mmc/ui';
```

## Examples

### Basic Usage

```typescript
import { ThemeManagerComponent } from '@mmc/ui';

@Component({
	template: ` <mmc-theme-manager [themes]="themeOptions" /> `,
})
export class AppComponent {
	themeOptions = [
		{ name: 'Light', value: 'light' },
		{ name: 'Dark', value: 'dark' },
		{ name: 'Auto', value: 'auto' },
	];
}
```

### Using the ThemeManager Service

```typescript
import { ThemeManager } from '@mmc/ui';

export class MyComponent {
	constructor(private themeManager: ThemeManager) {}

	setDarkMode() {
		this.themeManager.setTheme('dark');
	}

	getCurrentTheme() {
		return this.themeManager.theme();
	}
}
```

### Custom Theme

The component automatically includes a "Custom" option that allows users to:

- Choose a custom primary color
- Choose a custom background color
- Choose a custom foreground (text) color

Colors are converted to OKchLCH format and stored in localStorage.

```typescript
// Programmatically set custom colors
this.themeManager.setCustomTheme({
	primary: '#3b82f6',
	background: '#ffffff',
	foreground: '#000000',
});
```

## Theme Options

### Light Theme

The default light theme with bright backgrounds and dark text.

### Dark Theme

A dark theme with dark backgrounds and light text.

### Auto Theme

Automatically switches between light and dark based on the system preference.

### Custom Theme

Allows users to define their own color palette using color pickers.

## API Reference

### ThemeManagerComponent

<ArgTypes of={ThemeManagerComponent} />

### ThemeManager Service

The `ThemeManager` service provides methods to manage themes:

- `theme()`: Get the current theme (signal)
- `setTheme(theme)`: Set the active theme
- `customTheme()`: Get custom theme colors (signal)
- `setCustomTheme(colors)`: Set custom theme colors
- `themeChanged$`: Observable that emits when theme changes

## Accessibility

- Keyboard navigable select dropdown
- Screen reader friendly
- High contrast color options
- Respects system preferences with Auto theme

## Technical Details

The Theme Manager uses:

- `culori` library for color conversion (Hex to OKLCH)
- localStorage for persistence
- CSS variables for theme application
- Signals for reactive state management
