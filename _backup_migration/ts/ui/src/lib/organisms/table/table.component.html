<div class="space-y-4">
	<!-- Toolbar -->
	@if (showToolbar()) {
	<div class="flex items-center justify-between gap-4 mb-4">
		<div class="flex flex-1 items-center gap-2">
			@if (toolbarStart()) {
			<ng-container *ngTemplateOutlet="toolbarStart()"></ng-container>
			}
			@if (showSearch()) {
			<mmc-input-search class="max-w-sm flex-1" [placeholder]="searchPlaceholder()" [query]="searchQuery()"
				(queryChange)="onSearchChange($event)" />
			}
		</div>
		<div class="flex items-center gap-2">
			@if (toolbarEnd()) {
			<ng-container *ngTemplateOutlet="toolbarEnd()"></ng-container>
			}
			@if (showColumnVisibility()) {
			<button mmcButton variant="outline" size="sm" [mmcMenuTriggerFor]="columnMenu">
				<ng-icon name="lucideSettings2" size="16"></ng-icon>
				Edit columns
			</button>

			<ng-template #columnMenu>
				<div class="w-64" mmcMenu>
					<div role="group">
						<div class="px-3 py-2">
							<h4 class="text-sm text-muted-foreground">
								Toggle columns
							</h4>
						</div>
						@for (
						column of getVisibleColumns();
						track column.id
						) {
						<div mmcMenuItemCheckbox class="gap-2" [checked]="column.getIsVisible()"
							(click)="toggleColumnVisibility(column.id)">
							<mmc-checkbox [checked]="column.getIsVisible()"
								(click)="$event.stopPropagation()"></mmc-checkbox>
							<span class="text-sm">
								{{
								typeof column.columnDef
								.header === 'string'
								? column.columnDef.header
								: column.id
								}}
							</span>
						</div>
						}
					</div>
				</div>
			</ng-template>
			}
		</div>
	</div>
	}

	<!-- Table -->
	@switch (variant()) {
	@case ('primary') {
	<mmc-table-primary> </mmc-table-primary>
	}
	@case ('outline') {
	<mmc-table-outline> </mmc-table-outline>
	}
	@default {
	<mmc-table-primary> </mmc-table-primary>
	}
	}

	<!-- Pagination -->
	@if (pagination()) {
	<div class="flex items-center justify-between gap-8">
		<div class="flex items-center gap-3">
			<div class="flex items-center gap-3">
				<label class="max-sm:sr-only" htmlFor="rows-per-page" mmcLabel>Rows per page</label>
				<select [value]="pagination().pageSize" (change)="onPageSizeChange($event)"
					class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-base font-medium transition-[color,box-shadow] [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] disabled:opacity-50 disabled:cursor-not-allowed border border-input bg-background shadow-xs hover:bg-accent hover:text-accent-foreground w-30 h-8 w-12 p-0 pl-1">
					@for (pageSize of [5, 10, 25, 50]; track pageSize) {
					<option [value]="pageSize">{{ pageSize }}</option>
					}
				</select>
			</div>
		</div>

		<div class="flex items-center gap-4">
			<span class="text-sm text-muted-foreground">
				{{ startRow() }}-{{ endRow() }} of {{ dataSource().totalCount }}
			</span>
			<mmc-pagination [page]="currentPage()" [pageCount]="pages()"
				(pageChange)="onPageIndexChange($event)"></mmc-pagination>
		</div>
	</div>
	}
</div>

<!-- Selection Panel (sticky bottom) -->
@if (showSelectionPanel()) {
<div class="pointer-events-none fixed inset-x-0 bottom-0 z-50 flex items-center justify-center pb-4 animate-slide-up">
	<div
		class="pointer-events-auto flex items-center divide-x divide-background/20 rounded-xl border border-background/20 bg-foreground px-4 py-1 shadow-lg">
		<div class="flex items-center gap-3 pr-3">
			<mmc-checkbox
				class="border-background/40 data-[checked]:border-background data-[checked]:bg-background data-[checked]:text-foreground"
				[checked]="true" aria-label="Selected items"></mmc-checkbox>
			<span class="text-sm font-medium text-background">
				{{ selectedCount() }} item(s) selected
			</span>
		</div>
		@if (selectionActions()) {
		<div class="flex items-center gap-1 px-3">
			<ng-container *ngTemplateOutlet="selectionActions();context: { selectedCount: selectedCount() }">
			</ng-container>
		</div>
		}
		<div class="pl-3">
			<button mmcButton variant="ghost" size="icon" (click)="clearSelection()"
				class="size-8 rounded-full hover:bg-background/20 hover:text-background text-background">
				<mmc-icon name="lucideX" size="sm"></mmc-icon>
			</button>
		</div>
	</div>
</div>
}