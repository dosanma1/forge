<cdk-tree
    #tree
    [dataSource]="dataSource()"
    [levelAccessor]="levelAccessor">
    <cdk-tree-node
        *cdkTreeNodeDef="let node"
        cdkTreeNodePadding
        [style.display]="shouldRender(node) ? 'flex' : 'none'"
        [isDisabled]="!shouldRender(node)"
        [class]="'rounded-lg hover:bg-accent hover:text-accent-foreground ' + (isNodeOrChildSelected(node) ? 'bg-accent text-accent-foreground' : '')">
        <button
            mmcButton
            variant="ghost"
            class="w-full justify-start"
            (click)="onNodeClick(node)">
            <mmc-icon [name]="node.icon"> </mmc-icon>
            {{ node.name }}
        </button>
    </cdk-tree-node>
    <cdk-tree-node
        *cdkTreeNodeDef="let node; when: hasChild"
        cdkTreeNodePadding
        cdkTreeNodeToggle
        [cdkTreeNodeTypeaheadLabel]="node.name"
        [style.display]="shouldRender(node) ? 'flex' : 'none'"
        [isDisabled]="!shouldRender(node)"
        [isExpandable]="node.expandable"
        [class]="'rounded-lg hover:bg-accent hover:text-accent-foreground ' + (isNodeOrChildSelected(node) ? 'bg-accent text-accent-foreground' : '')">
        <button
            mmcButton
            variant="ghost"
            cdkTreeNodeToggle
            [attr.aria-label]="'Toggle ' + node.name"
            [style.visibility]="node.expandable ? 'visible' : 'hidden'"
            class="w-full justify-start"
            (click)="onNodeClick(node)">
            <mmc-icon [name]="tree.isExpanded(node) && node.expandedIcon ? node.expandedIcon : node.icon"> </mmc-icon>
            {{ node.name }}
        </button>
    </cdk-tree-node>
</cdk-tree>
